<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/style.css">
    <title>Shopping Catalog</title>
  </head>
  <body>
    <header>
      <h1>WAIS</h1>
      <div>
        {% if current_user.is_authenticated %}
          {% if current_user.is_admin %}
            <a class="cart-link" href="/admin">Admin</a>
          {% endif %}
          <a class="cart-link" href="/orders">Orders</a>
          <a class="cart-link" href="/logout">Logout</a>
        {% else %}
          <a class="cart-link" href="/login">Login</a>
          <a class="cart-link" href="/signup">Sign up</a>
        {% endif %}
        <a class="cart-link" href="/cart">Cart ({{ cart_count }})</a>
      </div>
    </header>

    <main>
      <form method="get" class="search-form">
        <input type="text" name="q" placeholder="Search products..." value="{{ search_query }}" />
        <button type="submit">Search</button>
      </form>

      <div class="grid">
        {% for p in products %}
        <div class="card">
          <img src="/{{ p.image if p.image else 'static/placeholder.svg' }}" alt="{{ p.name }}" style="width:120px;display:block;margin-bottom:8px">
          <h3>{{ p.name }}</h3>
          <p class="price">${{ '%.2f'|format(p.price) }}</p>
          <a class="btn" href="/add/{{ p.id }}">Add to cart</a>
        </div>
        {% endfor %}
      </div>
    </main>
  </body>
</html>
